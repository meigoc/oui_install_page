<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Blur Background</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: black;
        }
        canvas {
            position: absolute;
            width: 100vw;
            height: 100vh;
            filter: blur(10px);
        }
    </style>
</head>
<body>
    <canvas id="bgCanvas"></canvas>
    <script>
        const canvas = document.getElementById("bgCanvas");
        const ctx = canvas.getContext("2d");

        let bgGradient = null; // Кэшированный градиент
        let circles = [];

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            updateBackgroundGradient();
        }
        
        function updateBackgroundGradient() {
            const w = canvas.width, h = canvas.height;
            bgGradient = ctx.createLinearGradient(0, 0, w, h);
            bgGradient.addColorStop(0, "#1e90ff"); // Голубой
            bgGradient.addColorStop(1, "#001f3f"); // Темно-синий
        }

        window.addEventListener("resize", resizeCanvas);
        resizeCanvas();

        function createCircle() {
            if (circles.length >= 3) return;

            const x = Math.random() * canvas.width;
            const y = Math.random() * canvas.height;
            const maxRadius = Math.random() * 150 + 100;
            const duration = Math.random() * 3000 + 2000; // 2-5 секунд
            const color = `rgba(${Math.floor(Math.random() * 50 + 50)}, ${Math.floor(Math.random() * 150 + 150)}, 255, 0.5)`;

            const startTime = performance.now();
            circles.push({ x, y, maxRadius, radius: 0, color, startTime, duration, growing: true });
        }

        function drawBackground() {
            ctx.fillStyle = bgGradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        function drawCircles() {
            const now = performance.now();
            for (let i = circles.length - 1; i >= 0; i--) {
                let c = circles[i];
                let elapsed = now - c.startTime;

                if (elapsed >= c.duration) {
                    circles.splice(i, 1);
                    continue;
                }

                // Управление размером (увеличение → уменьшение)
                let progress = elapsed / c.duration;
                if (progress >= 0.5) {
                    c.growing = false;
                    progress = 1 - progress; // Инверсия уменьшения
                }
                c.radius = c.maxRadius * (progress * 2);

                const circleGradient = ctx.createRadialGradient(c.x, c.y, 0, c.x, c.y, c.radius);
                circleGradient.addColorStop(0, c.color);
                circleGradient.addColorStop(1, "rgba(255, 255, 255, 0)");

                ctx.fillStyle = circleGradient;
                ctx.beginPath();
                ctx.arc(c.x, c.y, c.radius, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawBackground();
            drawCircles();
            requestAnimationFrame(animate);
        }

        setInterval(createCircle, 2000);
        animate();
    </script>
</body>
</html>
